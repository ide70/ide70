---
unitInterface:
  descr: DB helper
  properties:
    dbIdInputName:
      descr: Name of input parameter holding database entity id
      valueCompleter:
        yamlPathCompleter:
          self: yes
          pathExpr: "[0].inputs.%"
    tableName:
      descr: Name of database table
      valueCompleter:
        fileNameCompleter:
          folderPrefix: dcfg/schema
          trimSuffix: .yaml
eventHandlers:
  onUnitCreate:
    action: |
      var dbIdInputName = CompCtx().GetProp("dbIdInputName");
      var dbTableName = CompCtx().GetProp("tableName");
      Api().Logger().Info("passParams", Event().GetUnit().GetPassParams());
      var dbId = Event().GetUnit().GetPassParams().Get(dbIdInputName);
      Api().Logger().Info("dbId", dbId);
      if(dbId) {
            var dbo = Event().DBCtx().FindDBO(dbTableName, dbId);
            if(dbo) {
                Event().GetUnit().InitializeStored(dbo.GetData());
            }
      }