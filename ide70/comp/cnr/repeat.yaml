---
unitInterface:
  descr: Container repeating children components
  properties:
    nrRows:
      descr: Number of rows initially
      default: 1
      type: int
    store:
      descr: Database field
privateProperties:
  value: Array of subcomponents data
body: |
  <table id="{{.sid}}">
  {{range $row := numRangeOpenEnd 0 $.nrRows}}
    <tr>
    <td>
    {{range $child := $.Children}}
    {{linearContext $.This $child $row | generateSubComp}}
    {{end}}
    </td>
    </tr>
  {{end}}
    <tr>
    <td>
    {{generateComp $.This "buttonAdd" "X" nil}}
    </td>
    </tr>
  </table>
eventHandlers:
  onUnitCreate:
    action: |
      var value = CompCtx().GetProp("value");
      if(value && value.length > 0) {
          CompCtx().SetProp("nrRows", value.length);
      }
autoInclude:
  - compType: button
    text: "+"
    cr: buttonAdd
    eventHandlers:
      onclick:
        action: |
          var parent = CompCtx().GetParentComp();
          var nrRows = parent.GetProp("nrRows");
          Api().Logger().Info("nrRows:", nrRows);
          nrRows++;
          parent.SetProp("nrRows", nrRows);
          parent.Refresh();
